<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Security & Linux Users Club</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/x-icon" href="images/logo.png">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
</head>

<body>
    <section id="hero">
        <div class="hero-content">
            <h2>Cyber Security Students Club</h2>
            <h2>(ADCET)</h2>
            <p>Join us to explore the world of cyber security, Linux, and open-source technology.</p>
            <a href="#join" class="cta-button">Upload Resume</a>
        </div>
    </section>

    <section id="about">
        <div class="container">
            <h2>About Us</h2>
            <p>Welcome to the Cyber Security Student Club (CSSC), a student-led initiative committed to fostering a
                secure digital environment. At CSSC, we believe that cybersecurity is not just a technical field but a
                vital practice that impacts every aspect of our connected lives.</p>
        </div>
    </section>

    <!-- Countdown and Form Section -->
    <section id="join">
        <div id="countdown-container">
            <div id="countdown"></div>
        </div>
        <div id="form-section" style="margin: auto;">
            <form id="signup-form">
                <h2 style="color: white">Upload Resume</h2>
                <div id="countdown" style="color: white;">Closes in <span id="time"> </span></div>

                <label for="name">Full Name:</label>
                <input type="text" id="name" name="name" required>

                <label for="Year">Year:</label>
                <select id="Year" name="Year" required>
                    <option value="2nd">2nd</option>
                    <option value="3rd">3rd</option>
                    <option value="4th">4th</option>
                </select>

                <label for="department">Department:</label>
                <input type="text" id="department" name="department" required>

                <label for="Resume">Upload Resume:</label>
                <input type="file" id="Resume" name="Resume" accept=".pdf, .doc, .docx" required>

                <button type="submit" id="submitButton">
                    Submit
                    <span class="loading-spinner" id="loadingSpinner" style="display: none;"></span>
                </button>
            </form>
        </div>
        <div id="closed-message" style="display: none;">
            <p>The form is closed.</p>
        </div>
    </section>

    <!-- Modal Structure -->
    <div id="successModal" class="modal">
        <div class="modal-content">
            <h2>Thank You!</h2>
            <p>Your Resume has been submitted successfully.</p>
            <button id="okButton" class="ok-button">OK</button>
        </div>
    </div>

    <section id="contact">
        <div class="container">
            <h2 style="color: white;">Contact Us:</h2>
        </div>
        <div class="contact-links">
            <a href="https://chat.whatsapp.com/K8YsAPh67G98PdubGo2TnI" target="_blank" class="contact-link">
                <img src="images/whatsapp.png" alt="WhatsApp Logo" style="box-shadow: 0 4px 8px rgba(0, 0, 0, 0)">
                <span>Join WhatsApp Group</span>
            </a>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>&copy; 2024 Cyber Security Students Club(ADCET). All rights reserved.</p>
        </div>
    </footer>
    <script>
        // Initialize Supabase
        const { createClient } = supabase;
        const supabaseUrl = 'https://edtlzmjyshstofnskogy.supabase.co';  // Replace with your Supabase project URL
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVkdGx6bWp5c2hzdG9mbnNrb2d5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjU2Mzg2MTUsImV4cCI6MjA0MTIxNDYxNX0.wkrNp4MP5Yhgv3S1kNyav9nTU5eFI4_mT_UxD0UOrbA';  // Replace with your Supabase public API key
        const supabase = createClient(supabaseUrl, supabaseKey);

        // Handle form submission
        document.getElementById('signup-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);

            // Handle file upload
            const resumeFile = formData.get('Resume');
            const { data: fileData, error: fileError } = await supabase.storage
                .from('resumes')
                .upload(`public/${resumeFile.name}`, resumeFile);

            if (fileError) {
                console.error('Error uploading file:', fileError);
                return;
            }

            const { data, error } = await supabase
                .from('resumes')
                .insert([
                    {
                        name: formData.get('name'),
                        year: formData.get('Year'),
                        department: formData.get('department'),
                        resume_url: fileData.Key // Store file URL or path
                    }
                ]);

            if (error) {
                console.error('Error uploading resume details:', error);
                return;
            }

            // Show success modal
            document.getElementById('successModal').style.display = 'block';
        });

        document.getElementById('okButton').addEventListener('click', () => {
            document.getElementById('successModal').style.display = 'none';
        });
    </script>
</body>

</html>